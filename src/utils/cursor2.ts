import { v4 as uuid } from "uuid";

export enum CursorType {
    Auto = 'auto',
    Rotate = 'rotate',
    Scale = 'scale',
    ScaleK = 'scale-k',
    Create = 'create',
    Extend = 'extend',
    Text = 'text',
    Grab = 'grab',
    Grabbing = 'grabbing',
    Pen = 'pen',
    Comment = 'comment'
}

export class CursorPicker {
    // 默认
    static DEFAULT = "data:image/svg+xml,<svg width='32' height='32' viewBox='0 0 32 32' fill='none' xmlns='http://www.w3.org/2000/svg'><g filter='url(%23filter0_d_328_9)'><path d='M9.00003 6.00005L10.543 24.0826L15.5 17.0001L23.7339 15.1138L9.00003 6.00005Z' fill='%23141414'/><path fill-rule='evenodd' clip-rule='evenodd' d='M8.00365 6.08507C7.99455 5.97809 8.00246 5.87204 8.02742 5.76761C8.05237 5.66318 8.09309 5.56531 8.14958 5.474C8.21933 5.36122 8.30802 5.26609 8.41563 5.18859C8.52323 5.11109 8.64157 5.05713 8.77064 5.02672C8.89972 4.9963 9.0297 4.99174 9.16058 5.01303C9.29147 5.03432 9.41331 5.07984 9.52608 5.1496L24.2599 14.2634C24.3737 14.3337 24.4694 14.4232 24.5472 14.532C24.625 14.6407 24.6788 14.7602 24.7086 14.8905C24.7233 14.9545 24.7316 15.0194 24.7335 15.085C24.7354 15.1506 24.7309 15.2158 24.7199 15.2805C24.709 15.3453 24.6918 15.4083 24.6684 15.4697C24.6451 15.5311 24.616 15.5896 24.581 15.6452C24.5462 15.7008 24.5062 15.7525 24.4611 15.8002C24.4161 15.848 24.3668 15.8909 24.3132 15.9289C24.2597 15.967 24.203 15.9994 24.1431 16.0263C24.0832 16.0531 24.0212 16.0739 23.9572 16.0886L16.0986 17.8889L11.3623 24.656C11.3203 24.7158 11.2718 24.7712 11.2178 24.8206C11.1638 24.8699 11.1052 24.9128 11.0418 24.9494C10.9784 24.9858 10.9118 25.015 10.842 25.0369C10.7722 25.0587 10.7009 25.0728 10.628 25.079C10.5626 25.0846 10.4973 25.0837 10.432 25.0764C10.3667 25.0691 10.3028 25.0555 10.2402 25.0357C10.1777 25.0158 10.1176 24.99 10.0601 24.9583C10.0026 24.9266 9.94878 24.8896 9.89857 24.8473C9.84836 24.8049 9.80276 24.7581 9.76177 24.7069C9.72078 24.6555 9.68519 24.6007 9.655 24.5425C9.6248 24.4841 9.60059 24.4234 9.58235 24.3604C9.56411 24.2973 9.5522 24.233 9.54662 24.1676L8.00365 6.08507ZM15.5 17.0001L10.543 24.0826L9.00003 6.00005L23.7339 15.1138L15.5 17.0001Z' fill='white'/></g><defs><filter id='filter0_d_328_9' x='6' y='3.99988' width='20.7344' height='24.0828' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'><feFlood flood-opacity='0' result='BackgroundImageFix'/><feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/><feOffset dy='1'/><feGaussianBlur stdDeviation='1'/><feComposite in2='hardAlpha' operator='out'/><feColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0'/><feBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_328_9'/><feBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_328_9' result='shape'/></filter></defs></svg>";
    // 旋转
    static ROTATE_SLICE = [
        "data:image/svg+xml,<svg width='32' height='32' viewBox='0 0 32 32' fill='none' xmlns='http://www.w3.org/2000/svg'><g transform='rotate(",
        " 16 16)' filter='url(%23filter0_d_326_2)'><path fill-rule='evenodd' clip-rule='evenodd' d='M13.7201 24.103L14.0655 20.3791C14.0563 20.2158 14.1178 20.0558 14.2338 19.9398C14.4581 19.7155 14.8207 19.7144 15.0437 19.9374L16.0491 20.9428L17.4251 19.5668C18.4014 18.5905 18.8908 17.4133 18.8933 16.035C18.8957 14.6568 18.4106 13.4813 17.4378 12.5085L16.0286 11.0993L15.0196 12.1083C14.7958 12.3321 14.4332 12.3324 14.2097 12.1089C14.0942 11.9933 14.0332 11.8335 14.043 11.6702L13.711 7.94747C13.7097 7.79325 13.7703 7.64497 13.8794 7.53586C13.9885 7.42675 14.1368 7.36608 14.291 7.3675L18.0137 7.69941C18.3295 7.68068 18.6001 7.92152 18.6185 8.23717C18.628 8.40051 18.5676 8.56032 18.4519 8.67607L17.4428 9.68511L18.852 11.0943C20.2139 12.4562 20.8931 14.1019 20.8896 16.0315C20.8862 17.961 20.201 19.6091 18.8342 20.976L17.4582 22.352L18.4636 23.3573C18.5789 23.4727 18.6388 23.6323 18.6287 23.7956C18.6092 24.1114 18.3376 24.3532 18.022 24.3356L14.298 24.6809C14.1438 24.6829 13.9957 24.6227 13.887 24.514C13.7783 24.4053 13.7182 24.2572 13.7201 24.103Z' fill='%23141414'/><path fill-rule='evenodd' clip-rule='evenodd' d='M12.7202 24.0904C12.7205 24.0637 12.7219 24.0372 12.7244 24.0107L13.0642 20.3464C13.061 19.9155 13.2152 19.5442 13.5267 19.2327C13.8333 18.9261 14.2032 18.7721 14.6363 18.7709C15.0718 18.7696 15.4432 18.9228 15.7508 19.2303L16.0491 19.5286L16.718 18.8597C17.4995 18.0782 17.8913 17.136 17.8933 16.0332C17.8952 14.9318 17.5077 13.9926 16.7307 13.2156L16.0286 12.5135L15.7267 12.8154C15.4197 13.1224 15.0493 13.276 14.6153 13.2764C14.1807 13.2766 13.8098 13.1232 13.5026 12.816C13.1905 12.5038 13.0368 12.1316 13.0416 11.6993L12.715 8.03628C12.7126 8.00974 12.7112 7.98315 12.711 7.95652C12.7071 7.51613 12.8608 7.14021 13.1723 6.82875C13.4838 6.51725 13.8597 6.3635 14.3 6.36751C14.3267 6.36774 14.3532 6.36906 14.3798 6.37147L18.0432 6.69808C18.4402 6.69426 18.7898 6.82677 19.0922 7.09562C19.4167 7.38426 19.5916 7.74542 19.6168 8.17911C19.6441 8.64924 19.4915 9.05059 19.159 9.38317L18.857 9.6851L19.5591 10.3872C21.1168 11.9448 21.8936 13.8269 21.8897 16.0332C21.8857 18.2382 21.1029 20.1215 19.5413 21.6831L18.8724 22.352L19.1707 22.6502C19.5039 22.9834 19.6559 23.3857 19.6268 23.8573C19.6001 24.2894 19.4249 24.6495 19.1012 24.9376C18.7996 25.2061 18.4509 25.3392 18.0551 25.3368L14.3904 25.6767C14.3639 25.6791 14.3373 25.6805 14.3107 25.6809C13.8689 25.6865 13.492 25.5332 13.1799 25.2211C12.8678 24.9091 12.7146 24.5321 12.7202 24.0904ZM18.022 24.3356L14.298 24.6809C14.1438 24.6829 13.9957 24.6227 13.887 24.514C13.7783 24.4053 13.7182 24.2572 13.7201 24.103L14.0655 20.3791C14.0563 20.2158 14.1178 20.0558 14.2338 19.9398C14.4581 19.7155 14.8207 19.7144 15.0437 19.9374L16.0491 20.9428L17.4251 19.5668C18.4014 18.5905 18.8908 17.4133 18.8933 16.035C18.8957 14.6568 18.4106 13.4813 17.4378 12.5085L16.0286 11.0993L15.0196 12.1083C14.7958 12.3321 14.4332 12.3324 14.2097 12.1089C14.0942 11.9933 14.0332 11.8335 14.043 11.6702L13.711 7.94747C13.7097 7.79325 13.7703 7.64497 13.8794 7.53586C13.9885 7.42675 14.1368 7.36608 14.291 7.3675L18.0137 7.69941C18.3295 7.68068 18.6001 7.92152 18.6185 8.23717C18.628 8.40051 18.5676 8.56032 18.4519 8.67607L17.4428 9.68511L18.852 11.0943C20.2139 12.4562 20.8931 14.1019 20.8896 16.0315C20.8862 17.961 20.201 19.6091 18.8342 20.976L17.4582 22.352L18.4636 23.3573C18.5789 23.4727 18.6388 23.6323 18.6287 23.7956C18.6092 24.1114 18.3376 24.3532 18.022 24.3356Z' fill='white'/></g><defs><filter id='filter0_d_326_2' x='10.7109' y='5.36743' width='13.1797' height='23.3136' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'><feFlood flood-opacity='0' result='BackgroundImageFix'/><feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/><feOffset dy='1'/><feGaussianBlur stdDeviation='1'/><feComposite in2='hardAlpha' operator='out'/><feColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0'/><feBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_326_2'/><feBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_326_2' result='shape'/></filter></defs></svg>"
    ];
    // 缩放
    static SCALE_SLICE = [
        "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' fill='none' width='32' height='32' viewBox='0 0 32 32'><defs><filter id='master_svg0_3051_9937' filterUnits='objectBoundingBox' color-interpolation-filters='sRGB' x='-4' y='-3' width='27.999954223632812' height='13.99998664855957'><feFlood flood-opacity='0' result='BackgroundImageFix'/><feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0'/><feOffset dy='1' dx='0'/><feGaussianBlur stdDeviation='1'/><feColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15000000596046448 0'/><feBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow'/><feBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow' result='shape'/></filter></defs><g transform='rotate(",
        " 16 16)'><g filter='url(%23master_svg0_3051_9937)'><path d='M9.05007,18.80775L6.172633,16.41007C6.0622299,16.30205,6.000023365,16.15425,6.000023365,15.99997C6.000023365,15.84569,6.0622301,15.697890000000001,6.172634,15.58987L9.05007,13.192233C9.2608,12.9556948,9.6238,12.9345752,9.86088,13.144831C9.98349,13.253574,10.054079999999999,13.409346,10.054079999999999,13.573026L10.054079999999999,15L21.9459,15L21.9459,13.573026C21.9459,13.409346,22.0165,13.253574,22.1391,13.144831C22.3762,12.9345752,22.7392,12.9556948,22.9499,13.192233L25.8274,15.58987C25.9378,15.697890000000001,26,15.84569,26,15.99997C26,16.15425,25.9378,16.30205,25.8274,16.41007L22.9499,18.80775C22.8409,18.93008,22.6843,18.99999,22.5202,18.99999C22.2031,18.99999,21.9459,18.74343,21.9459,18.426949999999998L21.9459,17L10.054079999999999,17L10.054079999999999,18.426949999999998C10.054079999999999,18.74343,9.79694,18.99999,9.47975,18.99999C9.3157,18.99999,9.15905,18.93008,9.05007,18.80775Z' fill-rule='evenodd' fill='%23141414' fill-opacity='1'/><path d='M9.05007,18.80775L6.172633,16.41007C6.0622299,16.30205,6.000023365,16.15425,6.000023365,15.99997C6.000023365,15.84569,6.0622301,15.697890000000001,6.172634,15.58987L9.05007,13.192233C9.2608,12.9556948,9.6238,12.9345752,9.86088,13.144831C9.98349,13.253574,10.054079999999999,13.409346,10.054079999999999,13.573026L10.054079999999999,15L21.9459,15L21.9459,13.573026C21.9459,13.409346,22.0165,13.253574,22.1391,13.144831C22.3762,12.9345752,22.7392,12.9556948,22.9499,13.192233L25.8274,15.58987C25.9378,15.697890000000001,26,15.84569,26,15.99997C26,16.15425,25.9378,16.30205,25.8274,16.41007L22.9499,18.80775C22.8409,18.93008,22.6843,18.99999,22.5202,18.99999C22.2031,18.99999,21.9459,18.74343,21.9459,18.426949999999998L21.9459,17L10.054079999999999,17L10.054079999999999,18.426949999999998C10.054079999999999,18.74343,9.79694,18.99999,9.47975,18.99999C9.3157,18.99999,9.15905,18.93008,9.05007,18.80775ZM11.054079999999999,18L11.054079999999999,18.426949999999998Q11.054079999999999,19.07919,10.59217,19.54005Q10.1312,19.99999,9.47975,19.99999Q8.81771,19.99999,8.36383,19.5376L5.532477,17.17831Q5.501809,17.15276,5.473276,17.12484Q5.000023,16.66179,5.000023,15.99997Q5.000023,15.33814,5.4732769999999995,14.8751Q5.501813,14.84717,5.532485,14.82162L8.36422,12.462057Q8.78159,12.038043,9.387319999999999,12.002684Q10.03737,11.964739999999999,10.5244,12.39668Q11.054079999999999,12.866442,11.054079999999999,13.573026L11.054079999999999,14L20.9459,14L20.9459,13.573026Q20.9459,12.86644,21.4756,12.396679Q21.962600000000002,11.964739999999999,22.6127,12.002684Q23.2184,12.038043,23.6358,12.462064L26.4675,14.82162Q26.4982,14.84717,26.5267,14.87509Q27,15.33814,27,15.99997Q27,16.66179,26.5267,17.12484Q26.4982,17.15276,26.4675,17.17831L23.6362,19.53759Q23.1823,19.99999,22.5202,19.99999Q21.8688,19.99999,21.4078,19.54005Q20.9459,19.07919,20.9459,18.426949999999998L20.9459,18L11.054079999999999,18Z' fill-rule='evenodd' fill='%23FFFFFF' fill-opacity='1'/></g></g></svg>"
    ]
    static SCALE_UNIFORM_SLICE = [
        "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'><g transform='rotate(",
        " 16 16)'><g style='transform:matrix(1,0,0,1,6.75,13);'><filter id='pd_outer-1066' x='-98.1081081081081%' y='-219.16666666666669%' height='638.3333333333333%' width='396.2162162162162%'><feFlood flood-opacity='0' result='BackgroundImageFix'/><feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0'/><feOffset dx='0' dy='0'/><feGaussianBlur stdDeviation='2.5'/><feColorMatrix type='matrix' values=' 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0'/><feBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow'/><feBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow' result='shape'/></filter><g filter='url(%23pd_outer-1066) '><path d='M 2.8212899999999994 5.807749999999999 L 0.15966400000000025 3.410070000000001 C 0.05754099999999962 3.3020449999999997 0 3.154250000000001 0 2.9999699999999994 C 0 2.8456849999999996 0.057541500000000134 2.697890000000001 0.15966449999999988 2.5898699999999995 L 2.8212899999999994 0.19223299999999988 C 3.016214999999999 -0.04430525000000074 3.352 -0.0654249999999994 3.57129 0.14483150000000045 C 3.684705000000001 0.25357449999999915 3.75 0.40934649999999984 3.75 0.5730249999999995 L 3.75 2 L 8.25 2 L 8.25 0 L 10.25 0 L 10.25 2 L 14.75 2 L 14.75 0.5730249999999995 C 14.75 0.40934649999999984 14.8153 0.25357449999999915 14.9287 0.14483150000000045 C 15.148 -0.0654249999999994 15.483800000000002 -0.04430525000000074 15.6787 0.19223299999999988 L 18.34035 2.5898699999999995 C 18.44245 2.697890000000001 18.5 2.8456849999999996 18.5 2.9999699999999994 C 18.5 3.154250000000001 18.44245 3.3020449999999997 18.34035 3.410070000000001 L 15.6787 5.807749999999999 C 15.5779 5.9300999999999995 15.433 6 15.28125 6 C 14.987850000000002 6 14.75 5.743449999999999 14.75 5.426949999999998 L 14.75 4 L 10.25 4 L 10.25 6 L 8.25 6 L 8.25 4 L 3.75 4 L 3.75 5.426949999999998 C 3.75 5.743449999999999 3.51215 6 3.21875 6 C 3.067005 6 2.922105 5.9300999999999995 2.8212899999999994 5.807749999999999 Z' fill='rgb(20,20,20)' fill-opacity='1' stroke='none' stroke-width='0' fill-rule='evenodd'/><g><mask id='mask-border10529808' x='-0.75' y='-0.75' width='20' height='7.5'><rect x='-0.75' y='-0.75' width='20' height='7.5' fill='white'/><path d='M 2.8212899999999994 5.807749999999999 L 0.15966400000000025 3.410070000000001 C 0.05754099999999962 3.3020449999999997 0 3.154250000000001 0 2.9999699999999994 C 0 2.8456849999999996 0.057541500000000134 2.697890000000001 0.15966449999999988 2.5898699999999995 L 2.8212899999999994 0.19223299999999988 C 3.016214999999999 -0.04430525000000074 3.352 -0.0654249999999994 3.57129 0.14483150000000045 C 3.684705000000001 0.25357449999999915 3.75 0.40934649999999984 3.75 0.5730249999999995 L 3.75 2 L 8.25 2 L 8.25 0 L 10.25 0 L 10.25 2 L 14.75 2 L 14.75 0.5730249999999995 C 14.75 0.40934649999999984 14.8153 0.25357449999999915 14.9287 0.14483150000000045 C 15.148 -0.0654249999999994 15.483800000000002 -0.04430525000000074 15.6787 0.19223299999999988 L 18.34035 2.5898699999999995 C 18.44245 2.697890000000001 18.5 2.8456849999999996 18.5 2.9999699999999994 C 18.5 3.154250000000001 18.44245 3.3020449999999997 18.34035 3.410070000000001 L 15.6787 5.807749999999999 C 15.5779 5.9300999999999995 15.433 6 15.28125 6 C 14.987850000000002 6 14.75 5.743449999999999 14.75 5.426949999999998 L 14.75 4 L 10.25 4 L 10.25 6 L 8.25 6 L 8.25 4 L 3.75 4 L 3.75 5.426949999999998 C 3.75 5.743449999999999 3.51215 6 3.21875 6 C 3.067005 6 2.922105 5.9300999999999995 2.8212899999999994 5.807749999999999 Z' fill='black'/></mask><path d='M 2.8212899999999994 5.807749999999999 L 0.15966400000000025 3.410070000000001 C 0.05754099999999962 3.3020449999999997 0 3.154250000000001 0 2.9999699999999994 C 0 2.8456849999999996 0.057541500000000134 2.697890000000001 0.15966449999999988 2.5898699999999995 L 2.8212899999999994 0.19223299999999988 C 3.016214999999999 -0.04430525000000074 3.352 -0.0654249999999994 3.57129 0.14483150000000045 C 3.684705000000001 0.25357449999999915 3.75 0.40934649999999984 3.75 0.5730249999999995 L 3.75 2 L 8.25 2 L 8.25 0 L 10.25 0 L 10.25 2 L 14.75 2 L 14.75 0.5730249999999995 C 14.75 0.40934649999999984 14.8153 0.25357449999999915 14.9287 0.14483150000000045 C 15.148 -0.0654249999999994 15.483800000000002 -0.04430525000000074 15.6787 0.19223299999999988 L 18.34035 2.5898699999999995 C 18.44245 2.697890000000001 18.5 2.8456849999999996 18.5 2.9999699999999994 C 18.5 3.154250000000001 18.44245 3.3020449999999997 18.34035 3.410070000000001 L 15.6787 5.807749999999999 C 15.5779 5.9300999999999995 15.433 6 15.28125 6 C 14.987850000000002 6 14.75 5.743449999999999 14.75 5.426949999999998 L 14.75 4 L 10.25 4 L 10.25 6 L 8.25 6 L 8.25 4 L 3.75 4 L 3.75 5.426949999999998 C 3.75 5.743449999999999 3.51215 6 3.21875 6 C 3.067005 6 2.922105 5.9300999999999995 2.8212899999999994 5.807749999999999 Z' fill='none' stroke='rgba(255,255,255,1)' stroke-linejoin='round' stroke-width='1.5' mask='url(%23mask-border10529808)'/></g></g></g></g></svg>",
    ]
    // 创建
    static CREATE = "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' fill='none' width='32' height='32' viewBox='0 0 32 32'><defs><filter id='master_svg0_3051_00276' filterUnits='objectBoundingBox' color-interpolation-filters='sRGB' x='-4' y='-3' width='24' height='24'><feFlood flood-opacity='0' result='BackgroundImageFix'/><feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0'/><feOffset dy='1' dx='0'/><feGaussianBlur stdDeviation='1'/><feColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15000000596046448 0'/><feBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow'/><feBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow' result='shape'/></filter></defs><g><g filter='url(%23master_svg0_3051_00276)'><path d='M15,17L15,24L17,24L17,17L24,17L24,15L17,15L17,8L15,8L15,15L8,15L8,17L15,17Z' fill-rule='evenodd' fill='%23141414' fill-opacity='1'/><path d='M15,18L15,17L8,17L8,15L15,15L15,8L17,8L17,15L24,15L24,17L17,17L17,24L15,24L15,18ZM14,18L8,18Q7.9015086,18,7.80491,17.98078Q7.708311,17.961570000000002,7.617317,17.92388Q7.526322,17.88619,7.44443,17.83147Q7.362537,17.77675,7.292893,17.70711Q7.223249,17.63746,7.16853,17.55557Q7.113812,17.47368,7.076121,17.38268Q7.03843,17.29169,7.019215,17.19509Q7,17.098489999999998,7,17L7,15Q7,14.90151,7.019215,14.80491Q7.03843,14.70831,7.076121,14.61732Q7.113812,14.52632,7.16853,14.44443Q7.223249,14.36254,7.292893,14.29289Q7.362537,14.22325,7.44443,14.16853Q7.526322,14.11381,7.617317,14.07612Q7.708311,14.03843,7.80491,14.019210000000001Q7.9015086,14,8,14L14,14L14,8Q14,7.9015086,14.019210000000001,7.80491Q14.03843,7.708311,14.07612,7.617317Q14.11381,7.526322,14.16853,7.44443Q14.22325,7.362537,14.29289,7.292893Q14.36254,7.223249,14.44443,7.16853Q14.52632,7.113812,14.61732,7.076121Q14.70831,7.03843,14.80491,7.019215Q14.90151,7,15,7L17,7Q17.098489999999998,7,17.19509,7.019215Q17.29169,7.03843,17.38268,7.076121Q17.47368,7.113812,17.55557,7.16853Q17.63746,7.223249,17.70711,7.292893Q17.77675,7.362537,17.83147,7.44443Q17.88619,7.526322,17.92388,7.617317Q17.961570000000002,7.708311,17.98078,7.80491Q18,7.9015086,18,8L18,14L24,14Q24.0985,14,24.1951,14.019210000000001Q24.2917,14.03843,24.3827,14.07612Q24.4737,14.11381,24.5556,14.16853Q24.6375,14.22325,24.7071,14.29289Q24.7767,14.36254,24.8315,14.44443Q24.8862,14.52632,24.9239,14.61732Q24.9616,14.70831,24.9808,14.80491Q25,14.90151,25,15L25,17Q25,17.098489999999998,24.9808,17.19509Q24.9616,17.29169,24.9239,17.38268Q24.8862,17.47368,24.8315,17.55557Q24.7767,17.63746,24.7071,17.70711Q24.6375,17.77675,24.5556,17.83147Q24.4737,17.88619,24.3827,17.92388Q24.2917,17.961570000000002,24.1951,17.98078Q24.0985,18,24,18L18,18L18,24Q18,24.0985,17.98078,24.1951Q17.961570000000002,24.2917,17.92388,24.3827Q17.88619,24.4737,17.83147,24.5556Q17.77675,24.6375,17.70711,24.7071Q17.63746,24.7767,17.55557,24.8315Q17.47368,24.8862,17.38268,24.9239Q17.29169,24.9616,17.19509,24.9808Q17.098489999999998,25,17,25L15,25Q14.90151,25,14.80491,24.9808Q14.70831,24.9616,14.61732,24.9239Q14.52632,24.8862,14.44443,24.8315Q14.36254,24.7767,14.29289,24.7071Q14.22325,24.6375,14.16853,24.5556Q14.11381,24.4737,14.07612,24.3827Q14.03843,24.2917,14.019210000000001,24.1951Q14,24.0985,14,24L14,18Z' fill-rule='evenodd' fill='%23FFF' /></g></g></svg>"
    // 扩展
    static EXTEND = "data:image/svg+xml,<svg width='32' height='32' viewBox='0 0 32 32' fill='none' xmlns='http://www.w3.org/2000/svg'><g filter='url(%23filter0_d_228_7)'><path d='M20.9098 11.0302L15.8939 6L11.2424 11.1643L14.5819 11.1731L14.6343 14.9508C13.4995 14.9443 12.3397 14.9437 11.0993 14.962L11.0993 11.0518L6 15.9975L11.0993 20.7201L11.1544 17.3811H14.668L14.7215 21.2374L11.3827 21.2837L16.1712 25.9981L21.0501 21.1496L17.1403 21.2038C17.1018 19.8585 17.0869 18.6079 17.0779 17.3811H21.2196V20.7201L26 15.9975L21.2196 11.0518V14.962C19.7518 14.9836 18.3969 14.9788 17.0628 14.9691C17.0539 13.7224 17.0391 12.4523 17 11.0844L20.9098 11.0302Z' fill='black'/><path d='M15.9087 6.58129L19.9592 10.6433L16.9944 10.6845L16.5885 10.6901L16.6001 11.0959C16.6392 12.4596 16.6539 13.7264 16.6629 14.9719L16.6657 15.3662L17.0599 15.3691C18.3949 15.3788 19.7533 15.3836 21.2255 15.3619L21.6196 15.3561V14.962V12.0412L25.4374 15.991L21.6196 19.7627V17.3811V16.9811H21.2196H17.0779H16.6749L16.6779 17.384C16.6869 18.612 16.7018 19.8659 16.7405 21.2153L16.7517 21.6092L17.1459 21.6038L20.0664 21.5633L16.1699 25.4355L12.3456 21.6703L14.727 21.6373L15.127 21.6318L15.1214 21.2318L15.0679 17.3755L15.0625 16.9811H14.668H11.1544H10.761L10.7545 17.3745L10.7141 19.8182L6.58144 15.9908L10.6993 11.997L10.6993 14.962V15.3679L11.1052 15.3619C12.3418 15.3437 13.4986 15.3443 14.632 15.3508L15.0399 15.3531L15.0342 14.9452L14.9818 11.1676L14.9764 10.7742L14.5829 10.7731L12.1389 10.7666L15.9087 6.58129Z' stroke='white' stroke-width='0.8'/></g><defs><filter id='filter0_d_228_7' x='2' y='2' width='28' height='27.9981' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'><feFlood flood-opacity='0' result='BackgroundImageFix'/><feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/><feOffset/><feGaussianBlur stdDeviation='2'/><feComposite in2='hardAlpha' operator='out'/><feColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0'/><feBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_228_7'/><feBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_228_7' result='shape'/></filter></defs></svg>"

    // 评论
    static COMMENT = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAABACAYAAABFqxrgAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAP/SURBVHgB7ZnPS1RRFMfPmxl1zPyRYUlaTIsIhGDCNq2sCFpUIITrBvdKrluM0jp04TJQ/wTXLppWLiQcSSwisEAhEFEbzRmd8fX9vnlXnmaINe/dN3E/cHj3/XDuOeeee+69RxGDWFIl2LZ9D5ckpMe9Jjyvs5BNyDQkY1lWVv4naDzkrX025iEpqXZgRMJr/MbGhj02NmanUik7kUjYLS0tNj+jJJNJu7e3156cnLSXl5e9zuBNQqoRKP6cdivjh4eHjxh9mtBRHmfwd15INQGF00p7jvxZjPcKo4WR4SEt1QBHTGnM0Ze/MP648HcUxWIxJWFmd3f3upoClXKA/O6IDfYjIcU6ODj4Si0nJiYq6gAlnFoE/WRwH5Gwsbe31++kciQzzmXxwQnMLUyyBNHwQEKGVSqVFqgcs7r44AA5Ni2QG95JmKJhbW3tjooC8dEBciwaNjc3HyoddHvDqq+vv89GJpMRv4HhMjU15bRjsdhtce3X6oTu7u5YXV3dU7anp6clCLLZ8rGipqamR0IyJeJIih8Yntz6is/TgcLES5CHvnV2dtaL5kMkOz+vFnAJwAHi5gVPn+zf0hYOZR0kKgHDvKCAQ2I4dutzwsjICCNB65xkFIhuJZqamgKfj8g9zjWfz3/c2tpy2jHRiBqJIEFidK5IjLnm5mYZGhoK4R7aZ1B8ca4rKysziIQD0UlfXx+TYmvQq4MqtmDT9KStre286FwisY+PICcE6gSeTcj29vaneDx+LQz7hEAjgZskFQWzs7Mv8ewypEZ0wkhAYroQlBNUqQ2rwirub7a2tjZRB9FMYNMhnU47fezv7+cGBgYe49mVrq6uWtH9fxd3FHx3gnIAmZube41nNyDNbmLWC5XwMxJ4RhgdHT10wMLCwpva2tpbeHdJdOcCD75EAo3n6KviCafAzMzMK7xLonbRies5CUtVqVLTgUYz83P5YzFVGU/W19fn+/v7n6F2wL3yVXdfoH8aeDiyRFYSGj8+Pj6I37/rToEOCB1wYgToPDtwJC0UVVahaIf8A1j2viMCvoDs4uLi58HBwfcopuZRtdopFAo8O/+AFCAnbpO1OQHTQRC+JSj6CLctqPlFoXhZqViMFWHLbYt6fgzHie6V8KMSQn8vGo3u4G9+NjQ05OCEvPvuj+cEnesk+27A9vUiRrIR0RBBVBz5AAZZSGyHxuIbUd+4bfWshEf7kAIML8Cxu+3t7fmlpaUipwfqJvZpiuiCfTMvxKW8ZEUaGxsll8t5R/iIfu57b1sZRyeo0S669yp5hpvyouAYGnFXi0Nx76PetrvBcdre7+1yXcIrBoPBYDAYDAaDwWAwGAwGg8FgMBgMBoPBoJ1fvWrb7M26VTYAAAAASUVORK5CYII=";

    // 动态光标类型
    static DYNAMIC = [CursorType.Rotate, CursorType.Scale, CursorType.ScaleK];

    static PEN = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJESURBVHgB7Zm9jcJAFIRHuojMJTi9jJBwSyC87NwBdIBLcAe4A64D3AEhISVAB3s7sGuWHxvzI7Rr3ieNZARYmrdv3voHEARBEARBEARBEARBEARBEARBEIRXMzTaWi2MMqMUH8TGSF/R0miKQ4F6DVe+Nq6UulYMFmluNMab+ML7+Ia3ykmSYL1eYzQaYTAYYLfbUYn9zY9Rbo8HRjurqFFGOk3TvXg8HA71drvVjtVqpYuiaOqOlVFhzxMlXN19DGi0qQiOzWaj5/O5Ho/H2nRLW1QSRERptF9lGrxVBJ/lcqmzLKv/g8tBmiGCXUXBDkC3yvcUoUNU2GEpAqaOgTP7aBEc/D2j4hWjQOCUsDHw8/5MEQgjgmMXBI2CF4NXFsEblgoBcxGDVxVhOp3GG4OmIlD8zI7hd21EH4NrRfDFFucO0Eb0MXA07Pf7a4E2ehEDgut3jo1d4+hNDJh9PNABpBcxWCwWF+YZi1uDkPQmBmxndgi7gSvfxbz7H/oQg2fAsXN+ETA3d4NHYLfgND5BF6FESwweNc9BOJlMoiiCwoti4Jt3F0yz2cyfB0E+eK1j0HXIdTXv8HaFPwRKCbvN3TPtu5gnPB8C3xVSowpnV3xlWT5tnnDAIpJtMcWhG+p3CG1d0cU84RMje74KkcC5kOHsbRKfEFdVdZd5fuddGmeIEAU7I+DdFuN+8zkiJ8VZV7TdGPXN/Dk5bBHyPP84844cXhE46SneRX6CeUeOhgcn+ADzDoXTawgeZxAEQejAP1zPK4aP9mgsAAAAAElFTkSuQmCC";

    private m_style: HTMLStyleElement;
    private m_class_map: Map<string, string> = new Map();
    private m_salt = '';

    constructor() {
        this.m_style = document.createElement('style');
        this.m_style.id = 'cursor-sheet';

        this.m_salt = uuid().split('-').pop() || 'cursor';

        this.createClass(CursorType.Auto, 0);

        document.querySelector('head')!.appendChild(this.m_style);
    }

    getHot(type: CursorType): [number, number] {
        if (type === CursorType.Auto) {
            return [0, 0];
        } else {
            return [16, 16];
        }
    }

    getSource(type: CursorType): string | string[] {
        switch (type) {
            case CursorType.Auto:
                return CursorPicker.DEFAULT;
            case CursorType.Create:
                return CursorPicker.CREATE;
            case CursorType.Scale:
                return CursorPicker.SCALE_SLICE;
            case CursorType.ScaleK:
                return CursorPicker.SCALE_UNIFORM_SLICE;
            case CursorType.Rotate:
                return CursorPicker.ROTATE_SLICE;
            case CursorType.Extend:
                return CursorPicker.EXTEND;
            case CursorType.Pen:
                return CursorPicker.PEN;
            case CursorType.Comment:
                return CursorPicker.COMMENT;
            default:
                return CursorPicker.DEFAULT;
        }
    }

    createClass(type: CursorType, degree: number) {
        const _source = this.getSource(type);

        const className = `${type}-${degree}-${this.m_salt}`
        let classStr = `.${className} {`

        let url;
        const dynamic = CursorPicker.DYNAMIC.includes(type);
        if (dynamic) {
            const source = _source as string[];
            url = source[0] + degree + source[1];
        } else {
            url = _source;
        }

        if (type === CursorType.Auto) {
            classStr += `cursor: url("${url}") 8 5, auto !important;`
        } else if (type === CursorType.Grab) {
            classStr += `cursor: grab !important;`
        } else if (type === CursorType.Grabbing) {
            classStr += `cursor: grabbing !important;`
        } else if (type === CursorType.Text) {
            classStr += 'cursor: text !important;'
        } else if (type === CursorType.Pen) {
            classStr += `cursor: -webkit-image-set(url(${url}) 2x) 13 13, auto !important;`
        } else if (type === CursorType.Comment) {
            classStr += `cursor: -webkit-image-set(url(${url}) 2x) 16 14, auto !important;`
        } else {
            classStr += `cursor: url("${url}") 16 16, auto !important;`
        }

        classStr += '}';

        this.m_class_map.set(`${type}-${degree}`, className);

        this.m_style.innerText += classStr;
    }

    getClass(type: CursorType, degree: number) {
        // 抽帧
        degree = this.findNearestMultipleOf(degree);

        const name = `${type}-${degree}`;

        // 已有的
        const fromMap = this.m_class_map.get(name);
        if (fromMap) {
            return fromMap;
        }

        // 创建新的
        this.createClass(type, degree);

        return `${type}-${degree}-${this.m_salt}`;
    }

    remove() {
        this.m_style.remove()
    }

    findNearestMultipleOf(num: number, step = 3): number {
        if (num < 0) num = num + 360;

        let closest = Math.round(num / step) * step;
        if (closest < num) closest += step;

        return closest;
    }
}